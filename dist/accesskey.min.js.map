{"version":3,"file":"accesskey.min.js","sources":["../src/accesskey.js"],"sourcesContent":["function isVisible(t) {\n  return !! (!t.hasAttribute('disabled') && t.getAttribute('aria-hidden') !== 'true' && t.offsetParent !== null);\n}\n\nfunction removeAccesskeyAttribute(selector) {\n  document.querySelectorAll(selector).forEach(function(el) {\n    el.removeAttribute('accesskey');\n  });\n}\nfunction addClass(selector, clsName) {\n  document.querySelectorAll(selector).forEach(function(el) {\n    el.classList.add(clsName);\n  });\n}\n\nfunction gi(i, len, op) {\n  let n = op == '+' ? +1 : -1;\n  i = i + n;\n  if (i >= len) {\n    i = 0;\n  }\n  if (i < 0) {\n    i = len - 1;\n  }\n  return i;\n}\n\nfunction _toFocus(el) {\n  let tagName = el.tagName.toLowerCase();\n  let tagNames = ['div', 'p', 'span', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'ul', 'ol', 'li', 'form', 'img', 'nav', 'header', 'main', 'footer', 'section', 'aside'];\n  if (tagNames.includes(tagName) || (tagName == 'a' && !el.hasAttribute('href'))) {\n    if (!el.hasAttribute('tabindex')) {\n      el.setAttribute('tabindex', '-1');\n    }\n  }\n  el.focus();\n}\n\nfunction toFocus(focusSelector, op) {\n  let els = [...document.body.querySelectorAll('*')];\n  let len = els.length;\n  let aeIndex = Math.max(0, els.indexOf(document.activeElement));\n  let i = aeIndex == 0 ? 0 : gi(aeIndex, len, op);\n  do {\n    if (els[i].matches(focusSelector) && isVisible(els[i])) {\n      _toFocus(els[i]);\n      break;\n    }\n    i = gi(i, len, op);\n  } while ( i != aeIndex );\n}\n\nfunction nextFocus(selector) {\n  toFocus(selector, '+');\n}\n\nfunction previousFocus(selector) {\n  toFocus(selector, '-');\n}\n\nfunction isIE() {\n  return ( !! window.ActiveXObject || \"ActiveXObject\" in window);\n}\n\nfunction accjsMutationObserver(proc, el) {\n    let mo = new MutationObserver((records) => {\n        proc();\n    });\n    mo.observe(el, {\n        'childList': true,\n        'subtree': true\n    });\n    return mo;\n}\nfunction accjsProc() {\n  document.querySelectorAll('[accesskey]').forEach(function(el) {\n    let key = el.getAttribute('accesskey');\nel.removeAttribute('accesskey');\nel.classList.add('accesskey-' + key);\n    if (!window.accjsAccesskeys.includes(key)) {\n      window.accjsAccesskeys.push(key);\n    }\n  });\n}\n\nif (!isIE()) {\n  window.accjsAccesskeys = [];\n  accjsProc();\n  document.addEventListener('keydown',\n  function(e) {\n    window.accjsAccesskeys.forEach(function(key) {\n      let keyCode = key.toUpperCase().charCodeAt();\n      if (e.altKey && e.shiftKey && e.keyCode == keyCode) {\n        e.preventDefault();\n        previousFocus('.accesskey-' + key);\n      } else if (e.altKey && e.keyCode == keyCode) {\n        e.preventDefault();\n        nextFocus('.accesskey-' + key);\n      }\n    });\n  },\n  null);\n  if(document.querySelectorAll('script[data-accjs-mutation-observer]').length > 0) {\n    accjsMutationObserver(accjsProc, document.body);\n  }\n}"],"names":["gi","i","len","op","_toFocus","el","tagName","toLowerCase","includes","hasAttribute","setAttribute","focus","toFocus","focusSelector","els","document","body","querySelectorAll","length","aeIndex","Math","max","indexOf","activeElement","matches","t","getAttribute","offsetParent","accjsProc","forEach","key","removeAttribute","classList","add","window","accjsAccesskeys","push","ActiveXObject","addEventListener","e","keyCode","toUpperCase","charCodeAt","altKey","shiftKey","preventDefault","selector","nextFocus","proc","mo","MutationObserver","records","observe","childList","subtree","accjsMutationObserver"],"mappings":"yBAeA,SAASA,EAAGC,EAAGC,EAAKC,GASlB,OAPAF,GADc,KAANE,EAAY,GAAM,IAEjBD,IACPD,EAAI,GAEFA,EAAI,IACNA,EAAIC,EAAM,GAELD,EAGT,SAASG,EAASC,GAChB,IAAIC,EAAUD,EAAGC,QAAQC,eACV,CAAC,MAAO,IAAK,OAAQ,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,OAAQ,MAAO,MAAO,SAAU,OAAQ,SAAU,UAAW,SAC1IC,SAASF,IAAwB,KAAXA,IAAmBD,EAAGI,aAAa,WAC/DJ,EAAGI,aAAa,aACnBJ,EAAGK,aAAa,WAAY,OAGhCL,EAAGM,QAGL,SAASC,EAAQC,EAAeV,GAC9B,IAAIW,EAAM,IAAIC,SAASC,KAAKC,iBAAiB,MACzCf,EAAMY,EAAII,OACVC,EAAUC,KAAKC,IAAI,EAAGP,EAAIQ,QAAQP,SAASQ,gBAC3CtB,EAAe,GAAXkB,EAAe,EAAInB,EAAGmB,EAASjB,EAAKC,GAC5C,EAAG,CACD,GAAIW,EAAIb,GAAGuB,QAAQX,OA5CJY,EA4CgCX,EAAIb,IA3CvCQ,aAAa,aAAiD,SAAlCgB,EAAEC,aAAa,gBAAgD,OAAnBD,EAAEE,cA2C9B,CACtDvB,EAASU,EAAIb,IACb,MAEFA,EAAID,EAAGC,EAAGC,EAAKC,SACPF,GAAKkB,GAjDjB,IAAmBM,EA0EnB,SAASG,IACPb,SAASE,iBAAiB,eAAeY,SAAQ,SAASxB,GACxD,IAAIyB,EAAMzB,EAAGqB,aAAa,aAC9BrB,EAAG0B,gBAAgB,aACnB1B,EAAG2B,UAAUC,IAAI,aAAeH,GACvBI,OAAOC,gBAAgB3B,SAASsB,IACnCI,OAAOC,gBAAgBC,KAAKN,MAnBpBI,OAAOG,eAAiB,kBAAmBH,SAyBvDA,OAAOC,gBAAkB,GACzBP,IACAb,SAASuB,iBAAiB,WAC1B,SAASC,GACPL,OAAOC,gBAAgBN,SAAQ,SAASC,GACtC,IAAIU,EAAUV,EAAIW,cAAcC,aAC5BH,EAAEI,QAAUJ,EAAEK,UAAYL,EAAEC,SAAWA,GACzCD,EAAEM,iBApCRjC,EAqCoB,cAAgBkB,EArClB,MAsCHS,EAAEI,QAAUJ,EAAEC,SAAWA,IAClCD,EAAEM,iBA5CV,SAAmBC,GACjBlC,EAAQkC,EAAU,KA4CZC,CAAU,cAAgBjB,SAIhC,MACGf,SAASE,iBAAiB,wCAAwCC,OAAS,GAtChF,SAA+B8B,EAAM3C,GACjC,IAAI4C,EAAK,IAAIC,iBAAkBC,IAC3BH,MAEJC,EAAGG,QAAQ/C,EAAI,CACXgD,WAAa,EACbC,SAAW,IAiCfC,CAAsB3B,EAAWb,SAASC"}